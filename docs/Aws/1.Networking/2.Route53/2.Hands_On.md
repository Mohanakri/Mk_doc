# Amazon Route 53 Hands-On Guide - AWS Console

## Prerequisites
- AWS Account with appropriate permissions
- Basic understanding of DNS concepts
- Optional: Domain name for testing (can use free services like Freenom)
- EC2 instances or other AWS resources for testing

---

## Lab 1: Creating and Configuring Public Hosted Zone

### Step 1: Create a Public Hosted Zone

1. **Navigate to Route 53**
   - Open AWS Management Console
   - Search for "Route 53" in services
   - Click on Route 53

2. **Create Hosted Zone**
   - Click "Hosted zones" in left navigation
   - Click "Create hosted zone"
   - Enter your domain name (e.g., `example.com`)
   - Keep "Public hosted zone" selected
   - Add optional description
   - Click "Create hosted zone"

3. **Note the Name Servers**
   - After creation, note the 4 NS records
   - These will be needed to configure your domain registrar
   - Example: `ns-123.awsdns-12.com`, `ns-456.awsdns-45.net`, etc.

### Step 2: Configure Domain Registrar (if using external domain)

1. **Access Domain Registrar**
   - Log into your domain registrar (GoDaddy, Namecheap, etc.)
   - Navigate to DNS management for your domain

2. **Update Name Servers**
   - Replace existing name servers with Route 53 NS records
   - Save changes
   - **Note**: Changes may take up to 48 hours to propagate

### Step 3: Create Basic DNS Records

1. **Create A Record**
   - In your hosted zone, click "Create record"
   - Record name: Leave blank for apex domain or enter subdomain (e.g., `www`)
   - Record type: Select "A"
   - Value: Enter IP address (e.g., `192.168.1.100`)
   - TTL: 300 seconds
   - Click "Create records"

2. **Create CNAME Record**
   - Click "Create record"
   - Record name: Enter subdomain (e.g., `blog`)
   - Record type: Select "CNAME"
   - Value: Enter target domain (e.g., `www.example.com`)
   - TTL: 300 seconds
   - Click "Create records"

---

## Lab 2: Setting Up Health Checks

### Step 1: Create HTTP Health Check

1. **Navigate to Health Checks**
   - In Route 53 console, click "Health checks"
   - Click "Create health check"

2. **Configure Health Check**
   - Name: `web-server-health-check`
   - What to monitor: Select "Endpoint"
   - Specify endpoint by: IP address or Domain name
   - Protocol: HTTP
   - IP address/Domain name: Enter your server's IP/domain
   - Port: 80
   - Path: `/` (or specific health check path)
   - Request interval: Standard (30 seconds)
   - Failure threshold: 3

3. **Configure Notifications (Optional)**
   - Create alarm: Yes
   - Send notification to: New SNS topic
   - Topic name: `route53-health-alerts`
   - Recipient email: Enter your email
   - Click "Create health check"

### Step 2: Test Health Check

1. **Monitor Status**
   - Wait 2-3 minutes for initial health check
   - Status should show "Success" if endpoint is healthy
   - Click on health check ID to view detailed status

2. **View Health Check Logs**
   - In CloudWatch, navigate to Logs
   - Look for Route 53 health check logs
   - Review success/failure patterns

---

## Lab 3: Implementing Routing Policies

### Step 1: Simple Routing Policy

1. **Create Simple Record**
   - In hosted zone, click "Create record"
   - Record name: `simple`
   - Record type: A
   - Value: Single IP address
   - Routing policy: Simple routing
   - Click "Create records"

### Step 2: Weighted Routing Policy

1. **Create First Weighted Record**
   - Click "Create record"
   - Record name: `weighted`
   - Record type: A
   - Value: First server IP (e.g., `192.168.1.10`)
   - Routing policy: Weighted routing
   - Weight: 70
   - Set ID: `server-1`
   - Click "Create records"

2. **Create Second Weighted Record**
   - Click "Create record"
   - Record name: `weighted` (same as above)
   - Record type: A
   - Value: Second server IP (e.g., `192.168.1.20`)
   - Routing policy: Weighted routing
   - Weight: 30
   - Set ID: `server-2`
   - Click "Create records"

### Step 3: Failover Routing Policy

1. **Create Primary Record**
   - Click "Create record"
   - Record name: `failover`
   - Record type: A
   - Value: Primary server IP
   - Routing policy: Failover routing
   - Failover record type: Primary
   - Health check: Select the health check created earlier
   - Set ID: `primary-server`
   - Click "Create records"

2. **Create Secondary Record**
   - Click "Create record"
   - Record name: `failover` (same as above)
   - Record type: A
   - Value: Secondary server IP
   - Routing policy: Failover routing
   - Failover record type: Secondary
   - Set ID: `secondary-server`
   - Click "Create records"

### Step 4: Geolocation Routing Policy

1. **Create US Record**
   - Click "Create record"
   - Record name: `geo`
   - Record type: A
   - Value: US server IP
   - Routing policy: Geolocation routing
   - Location: United States
   - Set ID: `us-server`
   - Click "Create records"

2. **Create Europe Record**
   - Click "Create record"
   - Record name: `geo` (same as above)
   - Record type: A
   - Value: Europe server IP
   - Routing policy: Geolocation routing
   - Location: Europe
   - Set ID: `europe-server`
   - Click "Create records"

3. **Create Default Record**
   - Click "Create record"
   - Record name: `geo` (same as above)
   - Record type: A
   - Value: Default server IP
   - Routing policy: Geolocation routing
   - Location: Default
   - Set ID: `default-server`
   - Click "Create records"

### Step 5: Latency Routing Policy

1. **Create US-East Record**
   - Click "Create record"
   - Record name: `latency`
   - Record type: A
   - Value: US-East server IP
   - Routing policy: Latency routing
   - Region: US East (N. Virginia)
   - Set ID: `us-east-server`
   - Click "Create records"

2. **Create EU-West Record**
   - Click "Create record"
   - Record name: `latency` (same as above)
   - Record type: A
   - Value: EU-West server IP
   - Routing policy: Latency routing
   - Region: Europe (Ireland)
   - Set ID: `eu-west-server`
   - Click "Create records"

---

## Lab 4: Working with Alias Records

### Step 1: Create Application Load Balancer (ALB)

1. **Navigate to EC2 Console**
   - Go to EC2 > Load Balancers
   - Click "Create Load Balancer"
   - Choose "Application Load Balancer"
   - Configure basic settings and create

2. **Note ALB DNS Name**
   - After creation, copy the DNS name
   - Example: `my-alb-123456789.us-east-1.elb.amazonaws.com`

### Step 2: Create Alias Record for ALB

1. **Create Alias Record**
   - In Route 53 hosted zone, click "Create record"
   - Record name: `app` (or leave blank for apex)
   - Record type: A
   - Alias: Toggle ON
   - Route traffic to: Alias to Application and Classic Load Balancer
   - Region: Select your ALB's region
   - Load balancer: Select your ALB from dropdown
   - Routing policy: Simple routing
   - Click "Create records"

### Step 3: Create S3 Website Alias Record

1. **Configure S3 Bucket for Website Hosting**
   - Create S3 bucket with exact domain name
   - Enable static website hosting
   - Upload index.html file

2. **Create S3 Alias Record**
   - Click "Create record"
   - Record name: `www`
   - Record type: A
   - Alias: Toggle ON
   - Route traffic to: Alias to S3 website endpoint
   - Region: Select your bucket's region
   - S3 bucket: Select your bucket from dropdown
   - Click "Create records"

---

## Lab 5: Private Hosted Zone Configuration

### Step 1: Create VPC (if needed)

1. **Navigate to VPC Console**
   - Create VPC with DNS resolution and DNS hostnames enabled
   - Note the VPC ID

### Step 2: Create Private Hosted Zone

1. **Create Private Hosted Zone**
   - In Route 53, click "Create hosted zone"
   - Domain name: `internal.company.com`
   - Type: Private hosted zone for Amazon VPC
   - Region: Select your VPC's region
   - VPC ID: Select your VPC
   - Click "Create hosted zone"

### Step 3: Create Private DNS Records

1. **Create Internal A Record**
   - Click "Create record"
   - Record name: `database`
   - Record type: A
   - Value: Private IP address (e.g., `10.0.1.100`)
   - TTL: 300
   - Click "Create records"

2. **Create Internal CNAME Record**
   - Click "Create record"
   - Record name: `db`
   - Record type: CNAME
   - Value: `database.internal.company.com`
   - TTL: 300
   - Click "Create records"

---

## Lab 6: Testing and Validation

### Step 1: Test DNS Resolution

1. **Using Command Line Tools**
   ```bash
   # Test A record
   nslookup simple.example.com
   
   # Test weighted routing (run multiple times)
   nslookup weighted.example.com
   
   # Test from different locations for geolocation
   nslookup geo.example.com
   ```

2. **Using Online DNS Tools**
   - Use tools like DNSChecker.org
   - Test from multiple global locations
   - Verify different routing policies work correctly

### Step 2: Monitor Health Checks

1. **CloudWatch Metrics**
   - Navigate to CloudWatch
   - View Route 53 health check metrics
   - Set up additional alarms if needed

2. **Health Check Dashboard**
   - In Route 53, review health check status
   - Test failover by stopping primary server
   - Verify secondary takes over

### Step 3: Performance Testing

1. **Test Latency Routing**
   - Use tools from different geographic locations
   - Verify lowest latency endpoint is returned
   - Compare response times

2. **Load Distribution Testing**
   - For weighted routing, perform multiple DNS queries
   - Verify traffic distribution matches configured weights
   - Use dig command with +short for cleaner output:
   ```bash
   dig +short weighted.example.com
   ```

---

## Lab 7: Advanced Configuration

### Step 1: Traffic Flow (Visual Editor)

1. **Create Traffic Flow Policy**
   - Navigate to Route 53 > Traffic flow
   - Click "Create traffic flow policy"
   - Use visual editor to create complex routing
   - Combine multiple routing types

2. **Apply Policy to Domain**
   - Create policy record in hosted zone
   - Test complex routing scenarios

### Step 2: Resolver Configuration (Hybrid DNS)

1. **Create Resolver Endpoints**
   - Navigate to Route 53 Resolver
   - Create inbound endpoint for on-premises queries
   - Create outbound endpoint for AWS queries to on-premises

2. **Configure Forwarding Rules**
   - Create rules for specific domains
   - Test bidirectional DNS resolution

---

## Troubleshooting Common Issues

### DNS Propagation Issues
- Use `dig` or `nslookup` to test specific name servers
- Check TTL values for cache timing
- Verify name server configuration at registrar

### Health Check Failures
- Verify security group allows health check traffic
- Check endpoint path and response codes
- Review CloudWatch logs for detailed error messages

### Alias Record Issues
- Ensure target resource exists and is accessible
- Verify correct region selection
- Check that target supports alias records

### Private Hosted Zone Problems
- Verify VPC DNS settings are enabled
- Check VPC association is correct
- Ensure instances are in associated VPC

---

## Cleanup Steps

### Remove Resources
1. Delete all DNS records (except NS and SOA)
2. Delete health checks
3. Delete hosted zones
4. Remove any created Load Balancers or S3 buckets
5. Delete VPC resources if created for testing

### Cost Optimization
- Monitor Route 53 charges in billing dashboard
- Remove unused health checks
- Clean up any Traffic Flow policies
- Delete unnecessary hosted zones

---

## Best Practices Summary

1. **Always use health checks** with failover routing
2. **Set appropriate TTL values** based on change frequency
3. **Use Alias records** instead of CNAME when possible
4. **Monitor health check status** regularly
5. **Test routing policies** from multiple locations
6. **Document DNS configuration** for team reference
7. **Use consistent naming conventions** for record sets
8. **Regular backup** of DNS configuration
9. **Plan for disaster recovery** scenarios
10. **Monitor costs** and optimize unused resources